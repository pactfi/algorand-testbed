#pragma version 8
intcblock 0 1 201 6
bytecblock 0x41444d494e 0x 0x5452454153555259 0x151f7c75 0x5505baf3 0x504f4f4c5f434f4e54524143545f56455253494f4e 0x414c4c4f5745445f4645455f425053 0x000000000000015e 0x414c4c4f5745445f504143545f4645455f425053 0x00000000000000aa
txn NumAppArgs
intc_0 // 0
==
bnz main_l16
txna ApplicationArgs 0
pushbytes 0xee5a0d15 // "build(asset,asset,uint64)uint64"
==
bnz main_l15
txna ApplicationArgs 0
pushbytes 0x8f0d7d8e // "change_admin(account)void"
==
bnz main_l14
txna ApplicationArgs 0
pushbytes 0xe6066415 // "change_treasury(account)void"
==
bnz main_l13
txna ApplicationArgs 0
pushbytes 0xc1315c59 // "create(account,account)void"
==
bnz main_l12
txna ApplicationArgs 0
pushbytes 0x6b41386f // "get_box_key(uint64,uint64,uint64)byte[]"
==
bnz main_l11
txna ApplicationArgs 0
pushbytes 0xbce9682d // "lookup(byte[])uint64"
==
bnz main_l10
txna ApplicationArgs 0
bytec 4 // "post_update()void"
==
bnz main_l9
err
main_l9:
txn OnCompletion
intc_0 // NoOp
==
txn ApplicationID
intc_0 // 0
!=
&&
assert
callsub postupdate_10
intc_1 // 1
return
main_l10:
txn OnCompletion
intc_0 // NoOp
==
txn ApplicationID
intc_0 // 0
!=
&&
assert
txna ApplicationArgs 1
callsub lookup_9
store 10
bytec_3 // 0x151f7c75
load 10
itob
concat
log
intc_1 // 1
return
main_l11:
txn OnCompletion
intc_0 // NoOp
==
txn ApplicationID
intc_0 // 0
!=
&&
assert
txna ApplicationArgs 1
btoi
store 6
txna ApplicationArgs 2
btoi
store 7
txna ApplicationArgs 3
btoi
store 8
load 6
load 7
load 8
callsub getboxkey_8
store 9
bytec_3 // 0x151f7c75
load 9
concat
log
intc_1 // 1
return
main_l12:
txn OnCompletion
intc_0 // NoOp
==
txn ApplicationID
intc_0 // 0
==
&&
assert
txna ApplicationArgs 1
intc_0 // 0
getbyte
store 4
txna ApplicationArgs 2
intc_0 // 0
getbyte
store 5
load 4
load 5
callsub create_7
intc_1 // 1
return
main_l13:
txn OnCompletion
intc_0 // NoOp
==
txn ApplicationID
intc_0 // 0
!=
&&
assert
txna ApplicationArgs 1
intc_0 // 0
getbyte
callsub changetreasury_6
intc_1 // 1
return
main_l14:
txn OnCompletion
intc_0 // NoOp
==
txn ApplicationID
intc_0 // 0
!=
&&
assert
txna ApplicationArgs 1
intc_0 // 0
getbyte
callsub changeadmin_5
intc_1 // 1
return
main_l15:
txn OnCompletion
intc_0 // NoOp
==
txn ApplicationID
intc_0 // 0
!=
&&
assert
txna ApplicationArgs 1
intc_0 // 0
getbyte
store 0
txna ApplicationArgs 2
intc_0 // 0
getbyte
store 1
txna ApplicationArgs 3
btoi
store 2
load 0
load 1
load 2
callsub build_4
store 3
bytec_3 // 0x151f7c75
load 3
itob
concat
log
intc_1 // 1
return
main_l16:
txn OnCompletion
pushint 4 // UpdateApplication
==
bnz main_l18
err
main_l18:
txn ApplicationID
intc_0 // 0
!=
assert
callsub update_3
intc_1 // 1
return

// auth_only
authonly_0:
proto 1 1
frame_dig -1
bytec_0 // "ADMIN"
app_global_get
==
retsub

// auth_only
authonly_1:
proto 1 1
frame_dig -1
bytec_0 // "ADMIN"
app_global_get
==
retsub

// auth_only
authonly_2:
proto 1 1
frame_dig -1
bytec_0 // "ADMIN"
app_global_get
==
retsub

// update
update_3:
proto 0 0
txn Sender
callsub authonly_2
// unauthorized
assert
txn GroupIndex
intc_1 // 1
+
gtxns OnCompletion
intc_0 // NoOp
==
assert
txn GroupIndex
intc_1 // 1
+
gtxns ApplicationID
global CurrentApplicationID
==
assert
txn GroupIndex
intc_1 // 1
+
gtxns NumAppArgs
intc_1 // 1
==
assert
txn GroupIndex
intc_1 // 1
+
gtxnsa ApplicationArgs 0
bytec 4 // 0x5505baf3
==
assert
retsub

// build
build_4:
proto 3 1
intc_0 // 0
dupn 2
bytec_1 // ""
intc_0 // 0
dup
frame_dig -3
txnas Assets
frame_bury 1
frame_dig -2
txnas Assets
frame_bury 2
frame_dig 1
itob
frame_dig 2
itob
concat
frame_dig -1
itob
concat
intc_2 // 201
itob
concat
frame_bury 3
frame_dig 3
len
itob
extract 6 0
frame_dig 3
concat
frame_bury 3
frame_dig 3
extract 2 0
box_get
store 12
store 11
load 12
bnz build_4_l7
intc_0 // 0
frame_bury 4
build_4_l2:
frame_dig 4
!
// Pool already exists
assert
itxn_begin
intc_3 // appl
itxn_field TypeEnum
frame_dig -1
itob
itxn_field ApplicationArgs
frame_dig -1
pushint 350 // 350
==
bnz build_4_l4
err
build_4_l4:
pushint 170 // 170
itob
itxn_field ApplicationArgs
bytec_0 // "ADMIN"
app_global_get
itxn_field ApplicationArgs
bytec_2 // "TREASURY"
app_global_get
itxn_field ApplicationArgs
frame_dig -3
txnas Assets
itxn_field Assets
frame_dig -2
txnas Assets
itxn_field Assets
pushbytes 0x08200701000204904e2003260b01410142014c044c5449440541444d494e085452454153555259074645455f4250530c504143545f4645455f42505306434f4e46494700013f31184000a33119231244363001443630003630011344361a001721040c44361a0117361a0017240a0e44361a0117231144361a021521051244361a0315210512442708363000163630011650361a0017165067800d434f4e54524143545f4e414d45800e5041435420414d4d205b4e46545d67800756455253494f4e81c901672823672923672a23672b23672704361a02672705361a03672706361a0017672707361a011767224327086435023402570008173500340257080817350131203203123630003400121036300134011210313121060e1031312106124006982210311923121044361a0080054f5054494e1240064a361a008003434c5412400591361a0080045357415012400412361a0080064144444c4951124001ce361a00800652454d4c495112400134361a00800c5749544844524157464545531240008f361a00800c4348414e47455f41444d494e12400063361a00800f4348414e47455f545245415355525912400034361a00800f4348414e47455f504143545f464545124000010031002704641244361a0117270664240a0e442707361a011767224331002704641244361c0115210512442705361c0167224331002704641244361c0115210512442704361c0167224327056434003400400077320a60320a780928640c4000663400400052320a60320a78092864098805b72705643401320a34017000351b351a341a29640c40002a320a34017000351b351a341a29640988058e3400400002224327056423320a60320a780988057942ffed2342ffe1320a3400700035193518341842ffa62342ffa5320a3400700035193518341842ff81311622093810251231162209382032031210311622093815320312103116220938112b641210311622093814320a1210442a6423134431162209381228641d2a6497351631162209381229641d2a6497351728286434160967292964341709672a2a6431162209381209673417361a021709483416361a011709483400341688049e3401341788049722432b64443400144002033116240938102512311624093820320312103116240938153203121031162409381134001210311624093814320a1210443116220938102512311622093820320312103116220938153203121031162209381134011210311622093814320a1210442a64231240013a34001440012b3116240938122a641d286497350f3116220938122a641d2964973510340f34104a0d4d361a01170948340f34104a0d4d230d442b64340f34104a0d4d8803de2a2a64340f34104a0d4d0867340f34100d40008b340f34100c40002728286434001440001531162409381208672929643116220938120867224331162409380842ffe82964351329296434001440004631162409381229641d2328641f11084c1444086731162209381229643413090935153401341588036528286434001440000b311624093812086742ffab31162409380842fff231162409380842ffb72864351228286431162209381228641d2329641f11084c14440867340014400023311624093812286434120909351434003414880309292964311622093812086742ff5531162409380842ffda31162409380842fed23400144000513116240938121631162209381216a3961735112a3411672834001440002a3116240938126729311622093812673411230935113411361a01170f443411442b64341188029e42fef531162409380842ffd331162409380842ffac31162409381022123116240938203203121031162409380932031210311624093807320a121042fe043400144001433116220938102512311622093820320312103116220938153203121031162209381134001210311622093814320a121040008f3116220938102512311622093820320312103116220938153203121031162209381134011210311622093814320a12104000042343224331162209381228641d29643116220938120897350c340c2707641d210497350e340c2104270664091d210497350d340d361a01170948282864340d0967282864340e096729296431162209381208673400340d88019a22433400144000723116220938122707641d210497350b3400144000543116220938122104270664091d2104973509340929641d286434090897350a340a361a01170948292964340a0967282864340014400014311622093812340b0908673401340a880134224331162209380842ffe931162209380842ffa931162209380842ff8b31162209381022123116220938203203121031162209380932031210311622093807320a121042fec43100320912442b642312443400144000913400710335063505340527091240007a340535033401710335083507340727091240005f34073504b123b2012106b21081ffffffffffffffffff01b2228106b223340380012f50340450800e2050414354204c5020546f6b656e50b2268003504c50b225801068747470733a2f2f706163742e66692fb227320ab22ab32bb43c672243270a350442ff9e270a350342ff838004414c474f350342ff7831003209124434001414400015b125b210320ab21423b2123401b21123b201b32243b125b210320ab21423b2123400b21123b201b342ffd53630022b641242f9608a02008bfe400013b122b2103100b2078bffb20823b201b3420014b125b2103100b2148bffb2128bfeb21123b201b3898a03008bfe400013b122b2108bfdb2078bffb20823b201b3420014b125b2108bfdb2148bffb2128bfeb21123b201b389 // 0x08200701000204904e2003260b01410142014c044c5449440541444d494e085452454153555259074645455f4250530c504143545f4645455f42505306434f4e46494700013f31184000a33119231244363001443630003630011344361a001721040c44361a0117361a0017240a0e44361a0117231144361a021521051244361a0315210512442708363000163630011650361a0017165067800d434f4e54524143545f4e414d45800e5041435420414d4d205b4e46545d67800756455253494f4e81c901672823672923672a23672b23672704361a02672705361a03672706361a0017672707361a011767224327086435023402570008173500340257080817350131203203123630003400121036300134011210313121060e1031312106124006982210311923121044361a0080054f5054494e1240064a361a008003434c5412400591361a0080045357415012400412361a0080064144444c4951124001ce361a00800652454d4c495112400134361a00800c5749544844524157464545531240008f361a00800c4348414e47455f41444d494e12400063361a00800f4348414e47455f545245415355525912400034361a00800f4348414e47455f504143545f464545124000010031002704641244361a0117270664240a0e442707361a011767224331002704641244361c0115210512442705361c0167224331002704641244361c0115210512442704361c0167224327056434003400400077320a60320a780928640c4000663400400052320a60320a78092864098805b72705643401320a34017000351b351a341a29640c40002a320a34017000351b351a341a29640988058e3400400002224327056423320a60320a780988057942ffed2342ffe1320a3400700035193518341842ffa62342ffa5320a3400700035193518341842ff81311622093810251231162209382032031210311622093815320312103116220938112b641210311622093814320a1210442a6423134431162209381228641d2a6497351631162209381229641d2a6497351728286434160967292964341709672a2a6431162209381209673417361a021709483416361a011709483400341688049e3401341788049722432b64443400144002033116240938102512311624093820320312103116240938153203121031162409381134001210311624093814320a1210443116220938102512311622093820320312103116220938153203121031162209381134011210311622093814320a1210442a64231240013a34001440012b3116240938122a641d286497350f3116220938122a641d2964973510340f34104a0d4d361a01170948340f34104a0d4d230d442b64340f34104a0d4d8803de2a2a64340f34104a0d4d0867340f34100d40008b340f34100c40002728286434001440001531162409381208672929643116220938120867224331162409380842ffe82964351329296434001440004631162409381229641d2328641f11084c1444086731162209381229643413090935153401341588036528286434001440000b311624093812086742ffab31162409380842fff231162409380842ffb72864351228286431162209381228641d2329641f11084c14440867340014400023311624093812286434120909351434003414880309292964311622093812086742ff5531162409380842ffda31162409380842fed23400144000513116240938121631162209381216a3961735112a3411672834001440002a3116240938126729311622093812673411230935113411361a01170f443411442b64341188029e42fef531162409380842ffd331162409380842ffac31162409381022123116240938203203121031162409380932031210311624093807320a121042fe043400144001433116220938102512311622093820320312103116220938153203121031162209381134001210311622093814320a121040008f3116220938102512311622093820320312103116220938153203121031162209381134011210311622093814320a12104000042343224331162209381228641d29643116220938120897350c340c2707641d210497350e340c2104270664091d210497350d340d361a01170948282864340d0967282864340e096729296431162209381208673400340d88019a22433400144000723116220938122707641d210497350b3400144000543116220938122104270664091d2104973509340929641d286434090897350a340a361a01170948292964340a0967282864340014400014311622093812340b0908673401340a880134224331162209380842ffe931162209380842ffa931162209380842ff8b31162209381022123116220938203203121031162209380932031210311622093807320a121042fec43100320912442b642312443400144000913400710335063505340527091240007a340535033401710335083507340727091240005f34073504b123b2012106b21081ffffffffffffffffff01b2228106b223340380012f50340450800e2050414354204c5020546f6b656e50b2268003504c50b225801068747470733a2f2f706163742e66692fb227320ab22ab32bb43c672243270a350442ff9e270a350342ff838004414c474f350342ff7831003209124434001414400015b125b210320ab21423b2123401b21123b201b32243b125b210320ab21423b2123400b21123b201b342ffd53630022b641242f9608a02008bfe400013b122b2103100b2078bffb20823b201b3420014b125b2103100b2148bffb2128bfeb21123b201b3898a03008bfe400013b122b2108bfdb2078bffb20823b201b3420014b125b2108bfdb2148bffb2128bfeb21123b201b389
itxn_field ApprovalProgram
pushbytes 0x08810143 // 0x08810143
itxn_field ClearStateProgram
pushint 4 // 4
itxn_field GlobalNumByteSlice
pushint 7 // 7
itxn_field GlobalNumUint
intc_1 // 1
itxn_field ExtraProgramPages
intc_0 // 0
itxn_field Fee
itxn_submit
itxn CreatedApplicationID
frame_bury 5
frame_dig 5
app_params_get AppAddress
store 14
store 13
itxn_begin
intc_1 // pay
itxn_field TypeEnum
load 13
itxn_field Receiver
frame_dig 1
bnz build_4_l6
pushint 300000 // 300000
b build_4_l8
build_4_l6:
pushint 400000 // 400000
b build_4_l8
build_4_l7:
load 11
btoi
frame_bury 4
b build_4_l2
build_4_l8:
itxn_field Amount
intc_0 // 0
itxn_field Fee
itxn_submit
itxn_begin
intc_3 // appl
itxn_field TypeEnum
frame_dig 5
itxn_field ApplicationID
pushbytes 0x4f5054494e // "OPTIN"
itxn_field ApplicationArgs
frame_dig 1
itxn_field Assets
frame_dig 2
itxn_field Assets
intc_0 // 0
itxn_field Fee
itxn_submit
itxn_begin
intc_3 // appl
itxn_field TypeEnum
frame_dig 5
itxn_field ApplicationID
pushbytes 0x434c54 // "CLT"
itxn_field ApplicationArgs
frame_dig 1
itxn_field Assets
frame_dig 2
itxn_field Assets
intc_0 // 0
itxn_field Fee
itxn_submit
frame_dig 3
extract 2 0
frame_dig 5
itob
box_put
frame_dig 5
frame_bury 0
retsub

// change_admin
changeadmin_5:
proto 1 0
txn Sender
callsub authonly_0
// unauthorized
assert
bytec_0 // "ADMIN"
frame_dig -1
txnas Accounts
app_global_put
retsub

// change_treasury
changetreasury_6:
proto 1 0
txn Sender
callsub authonly_1
// unauthorized
assert
bytec_2 // "TREASURY"
frame_dig -1
txnas Accounts
app_global_put
retsub

// create
create_7:
proto 2 0
bytec 5 // "POOL_CONTRACT_VERSION"
intc_2 // 201
app_global_put
bytec_0 // "ADMIN"
bytec_1 // ""
app_global_put
bytec 6 // "ALLOWED_FEE_BPS"
bytec 7 // 0x000000000000015e
app_global_put
bytec 8 // "ALLOWED_PACT_FEE_BPS"
bytec 9 // 0x00000000000000aa
app_global_put
bytec_2 // "TREASURY"
bytec_1 // ""
app_global_put
bytec_0 // "ADMIN"
frame_dig -2
txnas Accounts
app_global_put
bytec_2 // "TREASURY"
frame_dig -1
txnas Accounts
app_global_put
retsub

// get_box_key
getboxkey_8:
proto 3 1
bytec_1 // ""
frame_dig -3
itob
frame_dig -2
itob
concat
frame_dig -1
itob
concat
intc_2 // 201
itob
concat
frame_bury 0
frame_dig 0
len
itob
extract 6 0
frame_dig 0
concat
frame_bury 0
retsub

// lookup
lookup_9:
proto 1 1
intc_0 // 0
frame_dig -1
extract 2 0
box_get
store 16
store 15
load 16
bnz lookup_9_l2
intc_0 // 0
frame_bury 0
b lookup_9_l3
lookup_9_l2:
load 15
btoi
frame_bury 0
lookup_9_l3:
retsub

// post_update
postupdate_10:
proto 0 0
bytec 5 // "POOL_CONTRACT_VERSION"
intc_2 // 201
app_global_put
bytec 6 // "ALLOWED_FEE_BPS"
bytec 7 // 0x000000000000015e
app_global_put
bytec 8 // "ALLOWED_PACT_FEE_BPS"
bytec 9 // 0x00000000000000aa
app_global_put
retsub